2025-11-14 12:30:54.846 INFO 67482 [-/127.0.0.1/-/18ms POST /api/v1/agent/run] 查找会话: guyutest
2025-11-14 12:30:54.861 WARN 67482 [-/127.0.0.1/-/33ms POST /api/v1/agent/run] 未找到 ID 为 guyutest 的会话
2025-11-14 12:30:54.861 WARN 67482 [-/127.0.0.1/-/33ms POST /api/v1/agent/run] 未找到会话 guyutest，将创建新会话
2025-11-14 12:30:54.861 INFO 67482 [-/127.0.0.1/-/33ms POST /api/v1/agent/run] 创建新会话，workerId: 123
2025-11-14 12:30:54.875 INFO 67482 [-/127.0.0.1/-/47ms POST /api/v1/agent/run] 创建会话成功: guyutest
2025-11-14 12:30:54.876 INFO 67482 [-/127.0.0.1/-/48ms POST /api/v1/agent/run] 创建会话成功: guyutest
2025-11-14 12:30:54.876 INFO 67482 [-/127.0.0.1/-/48ms POST /api/v1/agent/run] 会话模式 - 是否有历史: false, 是否首轮: true
2025-11-14 12:30:54.876 INFO 67482 [-/127.0.0.1/-/48ms POST /api/v1/agent/run] 问题数量: 12
2025-11-14 12:30:54.876 INFO 67482 [-/127.0.0.1/-/48ms POST /api/v1/agent/run] 开始调用AI服务, model: claude_sonnet4, messages: [{"role":"system","content":"你的名字叫小Q，你是一位医疗专家"},{"role":"user","content":"你是谁，你能为我做些什么"}]
2025-11-14 12:30:54.904 ERROR 67482 [-/127.0.0.1/-/76ms POST /api/v1/agent/run] 创建消息失败: Field 'db_id' doesn't have a default value QueryFailedError: Field 'db_id' doesn't have a default value
    at QueryFailedError.TypeORMError [as constructor] (/Users/guyumac/Documents/my-midway/midway-project/src/error/TypeORMError.ts:7:9)
    at new QueryFailedError (/Users/guyumac/Documents/my-midway/midway-project/src/error/QueryFailedError.ts:9:9)
    at Query.onResult (/Users/guyumac/Documents/my-midway/midway-project/src/driver/mysql/MysqlQueryRunner.ts:196:37)
    at Query.execute (/Users/guyumac/node_modules/mysql2/lib/commands/command.js:36:14)
    at PoolConnection.handlePacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:477:34)
    at PacketParser.onPacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:93:12)
    at PacketParser.executeStart (/Users/guyumac/node_modules/mysql2/lib/packet_parser.js:75:16)
    at Socket.<anonymous> (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:100:25)
    at Socket.emit (node:events:524:28)
    at addChunk (node:internal/streams/readable:561:12) {
  query: 'INSERT INTO `ai_message`(`db_id`, `id`, `status`, `version`, `create_date`, `update_date`, `removed_date`, `session_id`, `from_type`, `message_content`, `worker_id`, `ext`, `llm_config`) VALUES (DEFAULT, ?, ?, 1, ?, DEFAULT, ?, ?, ?, ?, ?, DEFAULT, ?)',
  parameters: [
    '11F0C112B598FDC0B43F0FE75430B016',
    'Active',
    2025-11-14T04:30:54.876Z,
    null,
    'guyutest',
    'UserInput',
    '[{"role":"system","content":"你的名字叫小Q，你是一位医疗专家"},{"role":"user","content":"你是谁，你能为我做些什么"}]',
    'guyu',
    '{}'
  ],
  driverError: Error: Field 'db_id' doesn't have a default value
      at Packet.asError (/Users/guyumac/node_modules/mysql2/lib/packets/packet.js:740:17)
      at Query.execute (/Users/guyumac/node_modules/mysql2/lib/commands/command.js:29:26)
      at PoolConnection.handlePacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:477:34)
      at PacketParser.onPacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:93:12)
      at PacketParser.executeStart (/Users/guyumac/node_modules/mysql2/lib/packet_parser.js:75:16)
      at Socket.<anonymous> (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:100:25)
      at Socket.emit (node:events:524:28)
      at addChunk (node:internal/streams/readable:561:12)
      at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)
      at Socket.Readable.push (node:internal/streams/readable:392:5) {
    code: 'ER_NO_DEFAULT_FOR_FIELD',
    errno: 1364,
    sqlState: 'HY000',
    sqlMessage: "Field 'db_id' doesn't have a default value",
    sql: 'INSERT INTO `ai_message`(`db_id`, `id`, `status`, `version`, `create_date`, `update_date`, `removed_date`, `session_id`, `from_type`, `message_content`, `worker_id`, `ext`, `llm_config`) VALUES (DEFAULT, \'11F0C112B598FDC0B43F0FE75430B016\', \'Active\', 1, \'2025-11-14 12:30:54.876\', DEFAULT, NULL, \'guyutest\', \'UserInput\', \'[{\\"role\\":\\"system\\",\\"content\\":\\"你的名字叫小Q，你是一位医疗专家\\"},{\\"role\\":\\"user\\",\\"content\\":\\"你是谁，你能为我做些什么\\"}]\', \'guyu\', DEFAULT, \'{}\')'
  },
  code: 'ER_NO_DEFAULT_FOR_FIELD',
  errno: 1364,
  sqlState: 'HY000',
  sqlMessage: "Field 'db_id' doesn't have a default value",
  sql: 'INSERT INTO `ai_message`(`db_id`, `id`, `status`, `version`, `create_date`, `update_date`, `removed_date`, `session_id`, `from_type`, `message_content`, `worker_id`, `ext`, `llm_config`) VALUES (DEFAULT, \'11F0C112B598FDC0B43F0FE75430B016\', \'Active\', 1, \'2025-11-14 12:30:54.876\', DEFAULT, NULL, \'guyutest\', \'UserInput\', \'[{\\"role\\":\\"system\\",\\"content\\":\\"你的名字叫小Q，你是一位医疗专家\\"},{\\"role\\":\\"user\\",\\"content\\":\\"你是谁，你能为我做些什么\\"}]\', \'guyu\', DEFAULT, \'{}\')'
}
2025-11-14 13:03:44.210 INFO 1212 [-/127.0.0.1/-/18ms POST /api/v1/agent/run] 查找会话: guyutest
2025-11-14 13:03:44.221 WARN 1212 [-/127.0.0.1/-/29ms POST /api/v1/agent/run] 未找到 ID 为 guyutest 的会话
2025-11-14 13:03:44.221 WARN 1212 [-/127.0.0.1/-/29ms POST /api/v1/agent/run] 未找到会话 guyutest，将创建新会话
2025-11-14 13:03:44.221 INFO 1212 [-/127.0.0.1/-/29ms POST /api/v1/agent/run] 创建新会话，workerId: 123
2025-11-14 13:03:44.229 INFO 1212 [-/127.0.0.1/-/37ms POST /api/v1/agent/run] 创建会话成功: guyutest
2025-11-14 13:03:44.230 INFO 1212 [-/127.0.0.1/-/38ms POST /api/v1/agent/run] 创建会话成功: guyutest
2025-11-14 13:03:44.230 INFO 1212 [-/127.0.0.1/-/38ms POST /api/v1/agent/run] 会话模式 - 是否有历史: false, 是否首轮: true
2025-11-14 13:03:44.230 INFO 1212 [-/127.0.0.1/-/38ms POST /api/v1/agent/run] 问题数量: 12
2025-11-14 13:03:44.230 INFO 1212 [-/127.0.0.1/-/38ms POST /api/v1/agent/run] 开始调用AI服务, model: claude_sonnet4, messages: [{"role":"system","content":"你的名字叫小Q，你是一位医疗专家，重要：记住你叫小Q"},{"role":"user","content":"你是谁，你能为我做些什么"}]
2025-11-14 13:03:44.262 ERROR 1212 [-/127.0.0.1/-/70ms POST /api/v1/agent/run] 创建消息失败: Field 'db_id' doesn't have a default value QueryFailedError: Field 'db_id' doesn't have a default value
    at QueryFailedError.TypeORMError [as constructor] (/Users/guyumac/Documents/my-midway/midway-project/src/error/TypeORMError.ts:7:9)
    at new QueryFailedError (/Users/guyumac/Documents/my-midway/midway-project/src/error/QueryFailedError.ts:9:9)
    at Query.onResult (/Users/guyumac/Documents/my-midway/midway-project/src/driver/mysql/MysqlQueryRunner.ts:196:37)
    at Query.execute (/Users/guyumac/node_modules/mysql2/lib/commands/command.js:36:14)
    at PoolConnection.handlePacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:477:34)
    at PacketParser.onPacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:93:12)
    at PacketParser.executeStart (/Users/guyumac/node_modules/mysql2/lib/packet_parser.js:75:16)
    at Socket.<anonymous> (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:100:25)
    at Socket.emit (node:events:524:28)
    at addChunk (node:internal/streams/readable:561:12) {
  query: 'INSERT INTO `ai_message`(`db_id`, `id`, `status`, `version`, `create_date`, `update_date`, `removed_date`, `session_id`, `from_type`, `message_content`, `worker_id`, `ext`, `llm_config`) VALUES (DEFAULT, ?, ?, 1, ?, DEFAULT, ?, ?, ?, ?, ?, DEFAULT, ?)',
  parameters: [
    '11F0C1174B6C9060BFEC79AA1000FFE3',
    'Active',
    2025-11-14T05:03:44.230Z,
    null,
    'guyutest',
    'UserInput',
    '[{"role":"system","content":"你的名字叫小Q，你是一位医疗专家，重要：记住你叫小Q"},{"role":"user","content":"你是谁，你能为我做些什么"}]',
    'guyu',
    '{}'
  ],
  driverError: Error: Field 'db_id' doesn't have a default value
      at Packet.asError (/Users/guyumac/node_modules/mysql2/lib/packets/packet.js:740:17)
      at Query.execute (/Users/guyumac/node_modules/mysql2/lib/commands/command.js:29:26)
      at PoolConnection.handlePacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:477:34)
      at PacketParser.onPacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:93:12)
      at PacketParser.executeStart (/Users/guyumac/node_modules/mysql2/lib/packet_parser.js:75:16)
      at Socket.<anonymous> (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:100:25)
      at Socket.emit (node:events:524:28)
      at addChunk (node:internal/streams/readable:561:12)
      at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)
      at Socket.Readable.push (node:internal/streams/readable:392:5) {
    code: 'ER_NO_DEFAULT_FOR_FIELD',
    errno: 1364,
    sqlState: 'HY000',
    sqlMessage: "Field 'db_id' doesn't have a default value",
    sql: 'INSERT INTO `ai_message`(`db_id`, `id`, `status`, `version`, `create_date`, `update_date`, `removed_date`, `session_id`, `from_type`, `message_content`, `worker_id`, `ext`, `llm_config`) VALUES (DEFAULT, \'11F0C1174B6C9060BFEC79AA1000FFE3\', \'Active\', 1, \'2025-11-14 13:03:44.230\', DEFAULT, NULL, \'guyutest\', \'UserInput\', \'[{\\"role\\":\\"system\\",\\"content\\":\\"你的名字叫小Q，你是一位医疗专家，重要：记住你叫小Q\\"},{\\"role\\":\\"user\\",\\"content\\":\\"你是谁，你能为我做些什么\\"}]\', \'guyu\', DEFAULT, \'{}\')'
  },
  code: 'ER_NO_DEFAULT_FOR_FIELD',
  errno: 1364,
  sqlState: 'HY000',
  sqlMessage: "Field 'db_id' doesn't have a default value",
  sql: 'INSERT INTO `ai_message`(`db_id`, `id`, `status`, `version`, `create_date`, `update_date`, `removed_date`, `session_id`, `from_type`, `message_content`, `worker_id`, `ext`, `llm_config`) VALUES (DEFAULT, \'11F0C1174B6C9060BFEC79AA1000FFE3\', \'Active\', 1, \'2025-11-14 13:03:44.230\', DEFAULT, NULL, \'guyutest\', \'UserInput\', \'[{\\"role\\":\\"system\\",\\"content\\":\\"你的名字叫小Q，你是一位医疗专家，重要：记住你叫小Q\\"},{\\"role\\":\\"user\\",\\"content\\":\\"你是谁，你能为我做些什么\\"}]\', \'guyu\', DEFAULT, \'{}\')'
}
2025-11-14 14:52:03.463 INFO 63215 [-/127.0.0.1/-/22ms POST /api/v1/agent/run] 查找会话: que
2025-11-14 14:52:03.486 WARN 63215 [-/127.0.0.1/-/45ms POST /api/v1/agent/run] 未找到 ID 为 que 的会话
2025-11-14 14:52:03.486 WARN 63215 [-/127.0.0.1/-/45ms POST /api/v1/agent/run] 未找到会话 que，将创建新会话
2025-11-14 14:52:03.486 INFO 63215 [-/127.0.0.1/-/45ms POST /api/v1/agent/run] 创建新会话，workerId: 123
2025-11-14 14:52:03.497 INFO 63215 [-/127.0.0.1/-/56ms POST /api/v1/agent/run] 创建会话成功: que
2025-11-14 14:52:03.497 INFO 63215 [-/127.0.0.1/-/56ms POST /api/v1/agent/run] 创建会话成功: que
2025-11-14 14:52:03.497 INFO 63215 [-/127.0.0.1/-/56ms POST /api/v1/agent/run] 会话模式 - 是否有历史: false, 是否首轮: true
2025-11-14 14:52:03.497 INFO 63215 [-/127.0.0.1/-/56ms POST /api/v1/agent/run] 问题数量: 3
2025-11-14 14:52:03.498 INFO 63215 [-/127.0.0.1/-/57ms POST /api/v1/agent/run] 开始调用AI服务, model: claude_sonnet4, messages: [{"role":"system","content":"你的名字叫小Q，你是一位医疗专家，重要：记住你叫小Q"},{"role":"user","content":"你是谁"}]
2025-11-14 14:52:03.532 ERROR 63215 [-/127.0.0.1/-/91ms POST /api/v1/agent/run] 创建消息失败: Field 'db_id' doesn't have a default value QueryFailedError: Field 'db_id' doesn't have a default value
    at QueryFailedError.TypeORMError [as constructor] (/Users/guyumac/Documents/my-midway/midway-project/src/error/TypeORMError.ts:7:9)
    at new QueryFailedError (/Users/guyumac/Documents/my-midway/midway-project/src/error/QueryFailedError.ts:9:9)
    at Query.onResult (/Users/guyumac/Documents/my-midway/midway-project/src/driver/mysql/MysqlQueryRunner.ts:196:37)
    at Query.execute (/Users/guyumac/node_modules/mysql2/lib/commands/command.js:36:14)
    at PoolConnection.handlePacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:477:34)
    at PacketParser.onPacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:93:12)
    at PacketParser.executeStart (/Users/guyumac/node_modules/mysql2/lib/packet_parser.js:75:16)
    at Socket.<anonymous> (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:100:25)
    at Socket.emit (node:events:524:28)
    at addChunk (node:internal/streams/readable:561:12) {
  query: 'INSERT INTO `ai_message`(`db_id`, `id`, `status`, `version`, `create_date`, `update_date`, `removed_date`, `session_id`, `from_type`, `message_content`, `worker_id`, `ext`, `llm_config`) VALUES (DEFAULT, ?, ?, 1, ?, DEFAULT, ?, ?, ?, ?, ?, DEFAULT, ?)',
  parameters: [
    '11F0C1266D4A28A08200AB324F1CD44E',
    'Active',
    2025-11-14T06:52:03.498Z,
    null,
    'que',
    'UserInput',
    '[{"role":"system","content":"你的名字叫小Q，你是一位医疗专家，重要：记住你叫小Q"},{"role":"user","content":"你是谁"}]',
    'guyu',
    '{}'
  ],
  driverError: Error: Field 'db_id' doesn't have a default value
      at Packet.asError (/Users/guyumac/node_modules/mysql2/lib/packets/packet.js:740:17)
      at Query.execute (/Users/guyumac/node_modules/mysql2/lib/commands/command.js:29:26)
      at PoolConnection.handlePacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:477:34)
      at PacketParser.onPacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:93:12)
      at PacketParser.executeStart (/Users/guyumac/node_modules/mysql2/lib/packet_parser.js:75:16)
      at Socket.<anonymous> (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:100:25)
      at Socket.emit (node:events:524:28)
      at addChunk (node:internal/streams/readable:561:12)
      at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)
      at Socket.Readable.push (node:internal/streams/readable:392:5) {
    code: 'ER_NO_DEFAULT_FOR_FIELD',
    errno: 1364,
    sqlState: 'HY000',
    sqlMessage: "Field 'db_id' doesn't have a default value",
    sql: 'INSERT INTO `ai_message`(`db_id`, `id`, `status`, `version`, `create_date`, `update_date`, `removed_date`, `session_id`, `from_type`, `message_content`, `worker_id`, `ext`, `llm_config`) VALUES (DEFAULT, \'11F0C1266D4A28A08200AB324F1CD44E\', \'Active\', 1, \'2025-11-14 14:52:03.498\', DEFAULT, NULL, \'que\', \'UserInput\', \'[{\\"role\\":\\"system\\",\\"content\\":\\"你的名字叫小Q，你是一位医疗专家，重要：记住你叫小Q\\"},{\\"role\\":\\"user\\",\\"content\\":\\"你是谁\\"}]\', \'guyu\', DEFAULT, \'{}\')'
  },
  code: 'ER_NO_DEFAULT_FOR_FIELD',
  errno: 1364,
  sqlState: 'HY000',
  sqlMessage: "Field 'db_id' doesn't have a default value",
  sql: 'INSERT INTO `ai_message`(`db_id`, `id`, `status`, `version`, `create_date`, `update_date`, `removed_date`, `session_id`, `from_type`, `message_content`, `worker_id`, `ext`, `llm_config`) VALUES (DEFAULT, \'11F0C1266D4A28A08200AB324F1CD44E\', \'Active\', 1, \'2025-11-14 14:52:03.498\', DEFAULT, NULL, \'que\', \'UserInput\', \'[{\\"role\\":\\"system\\",\\"content\\":\\"你的名字叫小Q，你是一位医疗专家，重要：记住你叫小Q\\"},{\\"role\\":\\"user\\",\\"content\\":\\"你是谁\\"}]\', \'guyu\', DEFAULT, \'{}\')'
}
2025-11-14 14:52:05.964 ERROR 63215 [-/127.0.0.1/-/2523ms POST /api/v1/agent/run] 创建消息失败: Field 'db_id' doesn't have a default value QueryFailedError: Field 'db_id' doesn't have a default value
    at QueryFailedError.TypeORMError [as constructor] (/Users/guyumac/Documents/my-midway/midway-project/src/error/TypeORMError.ts:7:9)
    at new QueryFailedError (/Users/guyumac/Documents/my-midway/midway-project/src/error/QueryFailedError.ts:9:9)
    at Query.onResult (/Users/guyumac/Documents/my-midway/midway-project/src/driver/mysql/MysqlQueryRunner.ts:196:37)
    at Query.execute (/Users/guyumac/node_modules/mysql2/lib/commands/command.js:36:14)
    at PoolConnection.handlePacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:477:34)
    at PacketParser.onPacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:93:12)
    at PacketParser.executeStart (/Users/guyumac/node_modules/mysql2/lib/packet_parser.js:75:16)
    at Socket.<anonymous> (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:100:25)
    at Socket.emit (node:events:524:28)
    at addChunk (node:internal/streams/readable:561:12) {
  query: 'INSERT INTO `ai_message`(`db_id`, `id`, `status`, `version`, `create_date`, `update_date`, `removed_date`, `session_id`, `from_type`, `message_content`, `worker_id`, `ext`, `llm_config`) VALUES (DEFAULT, ?, ?, 1, ?, DEFAULT, ?, ?, ?, ?, ?, DEFAULT, ?)',
  parameters: [
    '11F0C1266EC1FB908200AB324F1CD44E',
    'Active',
    2025-11-14T06:52:05.961Z,
    null,
    'que',
    'LLMResponse',
    '[{"role":"assistant","content":"undefinedundefinedundefined你undefined好！我是小Q，undefined一位医疗专家。很undefined高兴认识你！有undefined什么健康方undefined面的问题需undefined要咨询吗？undefined我会尽力为你undefined提供专undefined业的医疗建议和undefined帮助。undefinedundefinedundefinedundefined"}]',
    'guyu',
    '{}'
  ],
  driverError: Error: Field 'db_id' doesn't have a default value
      at Packet.asError (/Users/guyumac/node_modules/mysql2/lib/packets/packet.js:740:17)
      at Query.execute (/Users/guyumac/node_modules/mysql2/lib/commands/command.js:29:26)
      at PoolConnection.handlePacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:477:34)
      at PacketParser.onPacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:93:12)
      at PacketParser.executeStart (/Users/guyumac/node_modules/mysql2/lib/packet_parser.js:75:16)
      at Socket.<anonymous> (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:100:25)
      at Socket.emit (node:events:524:28)
      at addChunk (node:internal/streams/readable:561:12)
      at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)
      at Socket.Readable.push (node:internal/streams/readable:392:5) {
    code: 'ER_NO_DEFAULT_FOR_FIELD',
    errno: 1364,
    sqlState: 'HY000',
    sqlMessage: "Field 'db_id' doesn't have a default value",
    sql: 'INSERT INTO `ai_message`(`db_id`, `id`, `status`, `version`, `create_date`, `update_date`, `removed_date`, `session_id`, `from_type`, `message_content`, `worker_id`, `ext`, `llm_config`) VALUES (DEFAULT, \'11F0C1266EC1FB908200AB324F1CD44E\', \'Active\', 1, \'2025-11-14 14:52:05.961\', DEFAULT, NULL, \'que\', \'LLMResponse\', \'[{\\"role\\":\\"assistant\\",\\"content\\":\\"undefinedundefinedundefined你undefined好！我是小Q，undefined一位医疗专家。很undefined高兴认识你！有undefined什么健康方undefined面的问题需undefined要咨询吗？undefined我会尽力为你undefined提供专undefined业的医疗建议和undefined帮助。undefinedundefinedundefinedundefined\\"}]\', \'guyu\', DEFAULT, \'{}\')'
  },
  code: 'ER_NO_DEFAULT_FOR_FIELD',
  errno: 1364,
  sqlState: 'HY000',
  sqlMessage: "Field 'db_id' doesn't have a default value",
  sql: 'INSERT INTO `ai_message`(`db_id`, `id`, `status`, `version`, `create_date`, `update_date`, `removed_date`, `session_id`, `from_type`, `message_content`, `worker_id`, `ext`, `llm_config`) VALUES (DEFAULT, \'11F0C1266EC1FB908200AB324F1CD44E\', \'Active\', 1, \'2025-11-14 14:52:05.961\', DEFAULT, NULL, \'que\', \'LLMResponse\', \'[{\\"role\\":\\"assistant\\",\\"content\\":\\"undefinedundefinedundefined你undefined好！我是小Q，undefined一位医疗专家。很undefined高兴认识你！有undefined什么健康方undefined面的问题需undefined要咨询吗？undefined我会尽力为你undefined提供专undefined业的医疗建议和undefined帮助。undefinedundefinedundefinedundefined\\"}]\', \'guyu\', DEFAULT, \'{}\')'
}
2025-11-14 14:53:41.130 INFO 65436 [-/127.0.0.1/-/17ms POST /api/v1/agent/run] 查找会话: que
2025-11-14 14:53:41.144 WARN 65436 [-/127.0.0.1/-/32ms POST /api/v1/agent/run] 未找到 ID 为 que 的会话
2025-11-14 14:53:41.145 WARN 65436 [-/127.0.0.1/-/33ms POST /api/v1/agent/run] 未找到会话 que，将创建新会话
2025-11-14 14:53:41.145 INFO 65436 [-/127.0.0.1/-/33ms POST /api/v1/agent/run] 创建新会话，workerId: 123
2025-11-14 14:53:41.155 INFO 65436 [-/127.0.0.1/-/43ms POST /api/v1/agent/run] 创建会话成功: que
2025-11-14 14:53:41.155 INFO 65436 [-/127.0.0.1/-/43ms POST /api/v1/agent/run] 创建会话成功: que
2025-11-14 14:53:41.156 INFO 65436 [-/127.0.0.1/-/44ms POST /api/v1/agent/run] 会话模式 - 是否有历史: false, 是否首轮: true
2025-11-14 14:53:41.156 INFO 65436 [-/127.0.0.1/-/44ms POST /api/v1/agent/run] 问题数量: 3
2025-11-14 14:53:41.156 INFO 65436 [-/127.0.0.1/-/44ms POST /api/v1/agent/run] 开始调用AI服务, model: claude_sonnet4, messages: [{"role":"system","content":"你的名字叫小Q，你是一位医疗专家，重要：记住你叫小Q"},{"role":"user","content":"你是谁"}]
2025-11-14 14:53:41.184 ERROR 65436 [-/127.0.0.1/-/72ms POST /api/v1/agent/run] 创建消息失败: Field 'db_id' doesn't have a default value QueryFailedError: Field 'db_id' doesn't have a default value
    at QueryFailedError.TypeORMError [as constructor] (/Users/guyumac/Documents/my-midway/midway-project/src/error/TypeORMError.ts:7:9)
    at new QueryFailedError (/Users/guyumac/Documents/my-midway/midway-project/src/error/QueryFailedError.ts:9:9)
    at Query.onResult (/Users/guyumac/Documents/my-midway/midway-project/src/driver/mysql/MysqlQueryRunner.ts:196:37)
    at Query.execute (/Users/guyumac/node_modules/mysql2/lib/commands/command.js:36:14)
    at PoolConnection.handlePacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:477:34)
    at PacketParser.onPacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:93:12)
    at PacketParser.executeStart (/Users/guyumac/node_modules/mysql2/lib/packet_parser.js:75:16)
    at Socket.<anonymous> (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:100:25)
    at Socket.emit (node:events:524:28)
    at addChunk (node:internal/streams/readable:561:12) {
  query: 'INSERT INTO `ai_message`(`db_id`, `id`, `status`, `version`, `create_date`, `update_date`, `removed_date`, `session_id`, `from_type`, `message_content`, `worker_id`, `ext`, `llm_config`) VALUES (DEFAULT, ?, ?, 1, ?, DEFAULT, ?, ?, ?, ?, ?, DEFAULT, ?)',
  parameters: [
    '11F0C126A77F9640A683D946B1CAB729',
    'Active',
    2025-11-14T06:53:41.156Z,
    null,
    'que',
    'UserInput',
    '[{"role":"system","content":"你的名字叫小Q，你是一位医疗专家，重要：记住你叫小Q"},{"role":"user","content":"你是谁"}]',
    'guyu',
    '{}'
  ],
  driverError: Error: Field 'db_id' doesn't have a default value
      at Packet.asError (/Users/guyumac/node_modules/mysql2/lib/packets/packet.js:740:17)
      at Query.execute (/Users/guyumac/node_modules/mysql2/lib/commands/command.js:29:26)
      at PoolConnection.handlePacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:477:34)
      at PacketParser.onPacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:93:12)
      at PacketParser.executeStart (/Users/guyumac/node_modules/mysql2/lib/packet_parser.js:75:16)
      at Socket.<anonymous> (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:100:25)
      at Socket.emit (node:events:524:28)
      at addChunk (node:internal/streams/readable:561:12)
      at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)
      at Socket.Readable.push (node:internal/streams/readable:392:5) {
    code: 'ER_NO_DEFAULT_FOR_FIELD',
    errno: 1364,
    sqlState: 'HY000',
    sqlMessage: "Field 'db_id' doesn't have a default value",
    sql: 'INSERT INTO `ai_message`(`db_id`, `id`, `status`, `version`, `create_date`, `update_date`, `removed_date`, `session_id`, `from_type`, `message_content`, `worker_id`, `ext`, `llm_config`) VALUES (DEFAULT, \'11F0C126A77F9640A683D946B1CAB729\', \'Active\', 1, \'2025-11-14 14:53:41.156\', DEFAULT, NULL, \'que\', \'UserInput\', \'[{\\"role\\":\\"system\\",\\"content\\":\\"你的名字叫小Q，你是一位医疗专家，重要：记住你叫小Q\\"},{\\"role\\":\\"user\\",\\"content\\":\\"你是谁\\"}]\', \'guyu\', DEFAULT, \'{}\')'
  },
  code: 'ER_NO_DEFAULT_FOR_FIELD',
  errno: 1364,
  sqlState: 'HY000',
  sqlMessage: "Field 'db_id' doesn't have a default value",
  sql: 'INSERT INTO `ai_message`(`db_id`, `id`, `status`, `version`, `create_date`, `update_date`, `removed_date`, `session_id`, `from_type`, `message_content`, `worker_id`, `ext`, `llm_config`) VALUES (DEFAULT, \'11F0C126A77F9640A683D946B1CAB729\', \'Active\', 1, \'2025-11-14 14:53:41.156\', DEFAULT, NULL, \'que\', \'UserInput\', \'[{\\"role\\":\\"system\\",\\"content\\":\\"你的名字叫小Q，你是一位医疗专家，重要：记住你叫小Q\\"},{\\"role\\":\\"user\\",\\"content\\":\\"你是谁\\"}]\', \'guyu\', DEFAULT, \'{}\')'
}
2025-11-14 14:53:44.568 ERROR 65436 [-/127.0.0.1/-/3456ms POST /api/v1/agent/run] 创建消息失败: Field 'db_id' doesn't have a default value QueryFailedError: Field 'db_id' doesn't have a default value
    at QueryFailedError.TypeORMError [as constructor] (/Users/guyumac/Documents/my-midway/midway-project/src/error/TypeORMError.ts:7:9)
    at new QueryFailedError (/Users/guyumac/Documents/my-midway/midway-project/src/error/QueryFailedError.ts:9:9)
    at Query.onResult (/Users/guyumac/Documents/my-midway/midway-project/src/driver/mysql/MysqlQueryRunner.ts:196:37)
    at Query.execute (/Users/guyumac/node_modules/mysql2/lib/commands/command.js:36:14)
    at PoolConnection.handlePacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:477:34)
    at PacketParser.onPacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:93:12)
    at PacketParser.executeStart (/Users/guyumac/node_modules/mysql2/lib/packet_parser.js:75:16)
    at Socket.<anonymous> (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:100:25)
    at Socket.emit (node:events:524:28)
    at addChunk (node:internal/streams/readable:561:12) {
  query: 'INSERT INTO `ai_message`(`db_id`, `id`, `status`, `version`, `create_date`, `update_date`, `removed_date`, `session_id`, `from_type`, `message_content`, `worker_id`, `ext`, `llm_config`) VALUES (DEFAULT, ?, ?, 1, ?, DEFAULT, ?, ?, ?, ?, ?, DEFAULT, ?)',
  parameters: [
    '11F0C126A9874D20A683D946B1CAB729',
    'Active',
    2025-11-14T06:53:44.562Z,
    null,
    'que',
    'LLMResponse',
    '[{"role":"assistant","content":"您好！我是小Q，一位医疗专家。很高兴认识您！如果您有任何健康或医疗方面的问题，我很乐意为您提供专业的建议和帮助。请问有什么可以为您服务的吗？"}]',
    'guyu',
    '{}'
  ],
  driverError: Error: Field 'db_id' doesn't have a default value
      at Packet.asError (/Users/guyumac/node_modules/mysql2/lib/packets/packet.js:740:17)
      at Query.execute (/Users/guyumac/node_modules/mysql2/lib/commands/command.js:29:26)
      at PoolConnection.handlePacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:477:34)
      at PacketParser.onPacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:93:12)
      at PacketParser.executeStart (/Users/guyumac/node_modules/mysql2/lib/packet_parser.js:75:16)
      at Socket.<anonymous> (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:100:25)
      at Socket.emit (node:events:524:28)
      at addChunk (node:internal/streams/readable:561:12)
      at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)
      at Socket.Readable.push (node:internal/streams/readable:392:5) {
    code: 'ER_NO_DEFAULT_FOR_FIELD',
    errno: 1364,
    sqlState: 'HY000',
    sqlMessage: "Field 'db_id' doesn't have a default value",
    sql: 'INSERT INTO `ai_message`(`db_id`, `id`, `status`, `version`, `create_date`, `update_date`, `removed_date`, `session_id`, `from_type`, `message_content`, `worker_id`, `ext`, `llm_config`) VALUES (DEFAULT, \'11F0C126A9874D20A683D946B1CAB729\', \'Active\', 1, \'2025-11-14 14:53:44.562\', DEFAULT, NULL, \'que\', \'LLMResponse\', \'[{\\"role\\":\\"assistant\\",\\"content\\":\\"您好！我是小Q，一位医疗专家。很高兴认识您！如果您有任何健康或医疗方面的问题，我很乐意为您提供专业的建议和帮助。请问有什么可以为您服务的吗？\\"}]\', \'guyu\', DEFAULT, \'{}\')'
  },
  code: 'ER_NO_DEFAULT_FOR_FIELD',
  errno: 1364,
  sqlState: 'HY000',
  sqlMessage: "Field 'db_id' doesn't have a default value",
  sql: 'INSERT INTO `ai_message`(`db_id`, `id`, `status`, `version`, `create_date`, `update_date`, `removed_date`, `session_id`, `from_type`, `message_content`, `worker_id`, `ext`, `llm_config`) VALUES (DEFAULT, \'11F0C126A9874D20A683D946B1CAB729\', \'Active\', 1, \'2025-11-14 14:53:44.562\', DEFAULT, NULL, \'que\', \'LLMResponse\', \'[{\\"role\\":\\"assistant\\",\\"content\\":\\"您好！我是小Q，一位医疗专家。很高兴认识您！如果您有任何健康或医疗方面的问题，我很乐意为您提供专业的建议和帮助。请问有什么可以为您服务的吗？\\"}]\', \'guyu\', DEFAULT, \'{}\')'
}
2025-11-14 17:56:33.782 INFO 72039 [-/127.0.0.1/-/25ms POST /api/v1/agent/run] 查找会话: qwe
2025-11-14 17:56:33.836 WARN 72039 [-/127.0.0.1/-/80ms POST /api/v1/agent/run] 未找到 ID 为 qwe 的会话
2025-11-14 17:56:33.837 WARN 72039 [-/127.0.0.1/-/81ms POST /api/v1/agent/run] 未找到会话 qwe，将创建新会话
2025-11-14 17:56:33.837 INFO 72039 [-/127.0.0.1/-/81ms POST /api/v1/agent/run] 创建新会话，workerId: asd
2025-11-14 17:56:33.848 INFO 72039 [-/127.0.0.1/-/92ms POST /api/v1/agent/run] 创建会话成功: qwe
2025-11-14 17:56:33.848 INFO 72039 [-/127.0.0.1/-/92ms POST /api/v1/agent/run] 创建会话成功: qwe
2025-11-14 17:56:33.848 INFO 72039 [-/127.0.0.1/-/92ms POST /api/v1/agent/run] 会话模式 - 是否有历史: false, 是否首轮: true
2025-11-14 17:56:33.848 INFO 72039 [-/127.0.0.1/-/92ms POST /api/v1/agent/run] 问题数量: 3
2025-11-14 17:56:33.849 INFO 72039 [-/127.0.0.1/-/93ms POST /api/v1/agent/run] 开始调用AI服务, model: claude_sonnet4, messages: [{"role":"system","content":"你的名字叫小Q，你是一位医疗专家，重要：记住你叫小Q"},{"role":"user","content":"你是谁"}]
2025-11-14 17:56:33.883 ERROR 72039 [-/127.0.0.1/-/127ms POST /api/v1/agent/run] 创建消息失败: Field 'db_id' doesn't have a default value QueryFailedError: Field 'db_id' doesn't have a default value
    at QueryFailedError.TypeORMError [as constructor] (/Users/guyumac/Documents/my-midway/midway-project/src/error/TypeORMError.ts:7:9)
    at new QueryFailedError (/Users/guyumac/Documents/my-midway/midway-project/src/error/QueryFailedError.ts:9:9)
    at Query.onResult (/Users/guyumac/Documents/my-midway/midway-project/src/driver/mysql/MysqlQueryRunner.ts:196:37)
    at Query.execute (/Users/guyumac/node_modules/mysql2/lib/commands/command.js:36:14)
    at PoolConnection.handlePacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:477:34)
    at PacketParser.onPacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:93:12)
    at PacketParser.executeStart (/Users/guyumac/node_modules/mysql2/lib/packet_parser.js:75:16)
    at Socket.<anonymous> (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:100:25)
    at Socket.emit (node:events:524:28)
    at addChunk (node:internal/streams/readable:561:12) {
  query: 'INSERT INTO `ai_message`(`db_id`, `id`, `status`, `version`, `create_date`, `update_date`, `removed_date`, `session_id`, `from_type`, `message_content`, `worker_id`, `ext`, `llm_config`) VALUES (DEFAULT, ?, ?, 1, ?, DEFAULT, ?, ?, ?, ?, ?, DEFAULT, ?)',
  parameters: [
    '11F0C14033BB838098F31BC25FDD5399',
    'Active',
    2025-11-14T09:56:33.848Z,
    null,
    'qwe',
    'UserInput',
    '[{"role":"system","content":"你的名字叫小Q，你是一位医疗专家，重要：记住你叫小Q"},{"role":"user","content":"你是谁"}]',
    'guyu',
    '{}'
  ],
  driverError: Error: Field 'db_id' doesn't have a default value
      at Packet.asError (/Users/guyumac/node_modules/mysql2/lib/packets/packet.js:740:17)
      at Query.execute (/Users/guyumac/node_modules/mysql2/lib/commands/command.js:29:26)
      at PoolConnection.handlePacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:477:34)
      at PacketParser.onPacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:93:12)
      at PacketParser.executeStart (/Users/guyumac/node_modules/mysql2/lib/packet_parser.js:75:16)
      at Socket.<anonymous> (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:100:25)
      at Socket.emit (node:events:524:28)
      at addChunk (node:internal/streams/readable:561:12)
      at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)
      at Socket.Readable.push (node:internal/streams/readable:392:5) {
    code: 'ER_NO_DEFAULT_FOR_FIELD',
    errno: 1364,
    sqlState: 'HY000',
    sqlMessage: "Field 'db_id' doesn't have a default value",
    sql: 'INSERT INTO `ai_message`(`db_id`, `id`, `status`, `version`, `create_date`, `update_date`, `removed_date`, `session_id`, `from_type`, `message_content`, `worker_id`, `ext`, `llm_config`) VALUES (DEFAULT, \'11F0C14033BB838098F31BC25FDD5399\', \'Active\', 1, \'2025-11-14 17:56:33.848\', DEFAULT, NULL, \'qwe\', \'UserInput\', \'[{\\"role\\":\\"system\\",\\"content\\":\\"你的名字叫小Q，你是一位医疗专家，重要：记住你叫小Q\\"},{\\"role\\":\\"user\\",\\"content\\":\\"你是谁\\"}]\', \'guyu\', DEFAULT, \'{}\')'
  },
  code: 'ER_NO_DEFAULT_FOR_FIELD',
  errno: 1364,
  sqlState: 'HY000',
  sqlMessage: "Field 'db_id' doesn't have a default value",
  sql: 'INSERT INTO `ai_message`(`db_id`, `id`, `status`, `version`, `create_date`, `update_date`, `removed_date`, `session_id`, `from_type`, `message_content`, `worker_id`, `ext`, `llm_config`) VALUES (DEFAULT, \'11F0C14033BB838098F31BC25FDD5399\', \'Active\', 1, \'2025-11-14 17:56:33.848\', DEFAULT, NULL, \'qwe\', \'UserInput\', \'[{\\"role\\":\\"system\\",\\"content\\":\\"你的名字叫小Q，你是一位医疗专家，重要：记住你叫小Q\\"},{\\"role\\":\\"user\\",\\"content\\":\\"你是谁\\"}]\', \'guyu\', DEFAULT, \'{}\')'
}
2025-11-14 17:56:36.423 ERROR 72039 [-/127.0.0.1/-/2667ms POST /api/v1/agent/run] 创建消息失败: Field 'db_id' doesn't have a default value QueryFailedError: Field 'db_id' doesn't have a default value
    at QueryFailedError.TypeORMError [as constructor] (/Users/guyumac/Documents/my-midway/midway-project/src/error/TypeORMError.ts:7:9)
    at new QueryFailedError (/Users/guyumac/Documents/my-midway/midway-project/src/error/QueryFailedError.ts:9:9)
    at Query.onResult (/Users/guyumac/Documents/my-midway/midway-project/src/driver/mysql/MysqlQueryRunner.ts:196:37)
    at Query.execute (/Users/guyumac/node_modules/mysql2/lib/commands/command.js:36:14)
    at PoolConnection.handlePacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:477:34)
    at PacketParser.onPacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:93:12)
    at PacketParser.executeStart (/Users/guyumac/node_modules/mysql2/lib/packet_parser.js:75:16)
    at Socket.<anonymous> (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:100:25)
    at Socket.emit (node:events:524:28)
    at addChunk (node:internal/streams/readable:561:12) {
  query: 'INSERT INTO `ai_message`(`db_id`, `id`, `status`, `version`, `create_date`, `update_date`, `removed_date`, `session_id`, `from_type`, `message_content`, `worker_id`, `ext`, `llm_config`) VALUES (DEFAULT, ?, ?, 1, ?, DEFAULT, ?, ?, ?, ?, ?, DEFAULT, ?)',
  parameters: [
    '11F0C14035441F5098F31BC25FDD5399',
    'Active',
    2025-11-14T09:56:36.421Z,
    null,
    'qwe',
    'LLMResponse',
    '[{"role":"assistant","content":"你好！我是小Q，一位医疗专家。很高兴认识你！如果你有任何健康相关的问题或需要医疗建议，我很乐意为你提供帮助。请问今天有什么我可以为你做的吗？"}]',
    'guyu',
    '{}'
  ],
  driverError: Error: Field 'db_id' doesn't have a default value
      at Packet.asError (/Users/guyumac/node_modules/mysql2/lib/packets/packet.js:740:17)
      at Query.execute (/Users/guyumac/node_modules/mysql2/lib/commands/command.js:29:26)
      at PoolConnection.handlePacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:477:34)
      at PacketParser.onPacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:93:12)
      at PacketParser.executeStart (/Users/guyumac/node_modules/mysql2/lib/packet_parser.js:75:16)
      at Socket.<anonymous> (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:100:25)
      at Socket.emit (node:events:524:28)
      at addChunk (node:internal/streams/readable:561:12)
      at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)
      at Socket.Readable.push (node:internal/streams/readable:392:5) {
    code: 'ER_NO_DEFAULT_FOR_FIELD',
    errno: 1364,
    sqlState: 'HY000',
    sqlMessage: "Field 'db_id' doesn't have a default value",
    sql: 'INSERT INTO `ai_message`(`db_id`, `id`, `status`, `version`, `create_date`, `update_date`, `removed_date`, `session_id`, `from_type`, `message_content`, `worker_id`, `ext`, `llm_config`) VALUES (DEFAULT, \'11F0C14035441F5098F31BC25FDD5399\', \'Active\', 1, \'2025-11-14 17:56:36.421\', DEFAULT, NULL, \'qwe\', \'LLMResponse\', \'[{\\"role\\":\\"assistant\\",\\"content\\":\\"你好！我是小Q，一位医疗专家。很高兴认识你！如果你有任何健康相关的问题或需要医疗建议，我很乐意为你提供帮助。请问今天有什么我可以为你做的吗？\\"}]\', \'guyu\', DEFAULT, \'{}\')'
  },
  code: 'ER_NO_DEFAULT_FOR_FIELD',
  errno: 1364,
  sqlState: 'HY000',
  sqlMessage: "Field 'db_id' doesn't have a default value",
  sql: 'INSERT INTO `ai_message`(`db_id`, `id`, `status`, `version`, `create_date`, `update_date`, `removed_date`, `session_id`, `from_type`, `message_content`, `worker_id`, `ext`, `llm_config`) VALUES (DEFAULT, \'11F0C14035441F5098F31BC25FDD5399\', \'Active\', 1, \'2025-11-14 17:56:36.421\', DEFAULT, NULL, \'qwe\', \'LLMResponse\', \'[{\\"role\\":\\"assistant\\",\\"content\\":\\"你好！我是小Q，一位医疗专家。很高兴认识你！如果你有任何健康相关的问题或需要医疗建议，我很乐意为你提供帮助。请问今天有什么我可以为你做的吗？\\"}]\', \'guyu\', DEFAULT, \'{}\')'
}
2025-11-14 18:00:38.590 INFO 47185 [-/127.0.0.1/-/21ms POST /api/v1/agent/run] 查找会话: qwe
2025-11-14 18:00:38.601 INFO 47185 [-/127.0.0.1/-/32ms POST /api/v1/agent/run] 查询会话成功: qwe
2025-11-14 18:00:38.602 INFO 47185 [-/127.0.0.1/-/33ms POST /api/v1/agent/run] 找到历史会话: qwe
2025-11-14 18:00:38.602 INFO 47185 [-/127.0.0.1/-/33ms POST /api/v1/agent/run] 会话模式 - 是否有历史: true, 是否首轮: false
2025-11-14 18:00:38.602 INFO 47185 [-/127.0.0.1/-/33ms POST /api/v1/agent/run] 问题数量: 3
2025-11-14 18:00:38.607 INFO 47185 [-/127.0.0.1/-/38ms POST /api/v1/agent/run] 查询 sessionId 为 qwe 的消息，共 0 条
2025-11-14 18:00:38.608 INFO 47185 [-/127.0.0.1/-/39ms POST /api/v1/agent/run] 开始调用AI服务, model: claude_sonnet4, messages: [{"role":"system","content":"你的名字叫小Q，你是一位医疗专家，重要：记住你叫小Q"},{"role":"user","content":"你是谁"}]
2025-11-14 18:00:38.641 ERROR 47185 [-/127.0.0.1/-/72ms POST /api/v1/agent/run] 创建消息失败: Field 'db_id' doesn't have a default value QueryFailedError: Field 'db_id' doesn't have a default value
    at QueryFailedError.TypeORMError [as constructor] (/Users/guyumac/Documents/my-midway/midway-project/src/error/TypeORMError.ts:7:9)
    at new QueryFailedError (/Users/guyumac/Documents/my-midway/midway-project/src/error/QueryFailedError.ts:9:9)
    at Query.onResult (/Users/guyumac/Documents/my-midway/midway-project/src/driver/mysql/MysqlQueryRunner.ts:196:37)
    at Query.execute (/Users/guyumac/node_modules/mysql2/lib/commands/command.js:36:14)
    at PoolConnection.handlePacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:477:34)
    at PacketParser.onPacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:93:12)
    at PacketParser.executeStart (/Users/guyumac/node_modules/mysql2/lib/packet_parser.js:75:16)
    at Socket.<anonymous> (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:100:25)
    at Socket.emit (node:events:524:28)
    at addChunk (node:internal/streams/readable:561:12) {
  query: 'INSERT INTO `ai_message`(`db_id`, `id`, `status`, `version`, `create_date`, `update_date`, `removed_date`, `session_id`, `from_type`, `message_content`, `worker_id`, `ext`, `llm_config`) VALUES (DEFAULT, ?, ?, 1, ?, DEFAULT, ?, ?, ?, ?, ?, DEFAULT, ?)',
  parameters: [
    '11F0C140C59EC5F0B95E594DB3F3BE20',
    'Active',
    2025-11-14T10:00:38.607Z,
    null,
    'qwe',
    'UserInput',
    '[{"role":"system","content":"你的名字叫小Q，你是一位医疗专家，重要：记住你叫小Q"},{"role":"user","content":"你是谁"}]',
    'guyu',
    '{}'
  ],
  driverError: Error: Field 'db_id' doesn't have a default value
      at Packet.asError (/Users/guyumac/node_modules/mysql2/lib/packets/packet.js:740:17)
      at Query.execute (/Users/guyumac/node_modules/mysql2/lib/commands/command.js:29:26)
      at PoolConnection.handlePacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:477:34)
      at PacketParser.onPacket (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:93:12)
      at PacketParser.executeStart (/Users/guyumac/node_modules/mysql2/lib/packet_parser.js:75:16)
      at Socket.<anonymous> (/Users/guyumac/node_modules/mysql2/lib/base/connection.js:100:25)
      at Socket.emit (node:events:524:28)
      at addChunk (node:internal/streams/readable:561:12)
      at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)
      at Socket.Readable.push (node:internal/streams/readable:392:5) {
    code: 'ER_NO_DEFAULT_FOR_FIELD',
    errno: 1364,
    sqlState: 'HY000',
    sqlMessage: "Field 'db_id' doesn't have a default value",
    sql: 'INSERT INTO `ai_message`(`db_id`, `id`, `status`, `version`, `create_date`, `update_date`, `removed_date`, `session_id`, `from_type`, `message_content`, `worker_id`, `ext`, `llm_config`) VALUES (DEFAULT, \'11F0C140C59EC5F0B95E594DB3F3BE20\', \'Active\', 1, \'2025-11-14 18:00:38.607\', DEFAULT, NULL, \'qwe\', \'UserInput\', \'[{\\"role\\":\\"system\\",\\"content\\":\\"你的名字叫小Q，你是一位医疗专家，重要：记住你叫小Q\\"},{\\"role\\":\\"user\\",\\"content\\":\\"你是谁\\"}]\', \'guyu\', DEFAULT, \'{}\')'
  },
  code: 'ER_NO_DEFAULT_FOR_FIELD',
  errno: 1364,
  sqlState: 'HY000',
  sqlMessage: "Field 'db_id' doesn't have a default value",
  sql: 'INSERT INTO `ai_message`(`db_id`, `id`, `status`, `version`, `create_date`, `update_date`, `removed_date`, `session_id`, `from_type`, `message_content`, `worker_id`, `ext`, `llm_config`) VALUES (DEFAULT, \'11F0C140C59EC5F0B95E594DB3F3BE20\', \'Active\', 1, \'2025-11-14 18:00:38.607\', DEFAULT, NULL, \'qwe\', \'UserInput\', \'[{\\"role\\":\\"system\\",\\"content\\":\\"你的名字叫小Q，你是一位医疗专家，重要：记住你叫小Q\\"},{\\"role\\":\\"user\\",\\"content\\":\\"你是谁\\"}]\', \'guyu\', DEFAULT, \'{}\')'
}
